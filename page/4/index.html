<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"c2lang.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Jasper Ji">
<meta property="og:url" content="https://c2lang.com/page/4/index.html">
<meta property="og:site_name" content="Jasper Ji">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Jasper Ji">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://c2lang.com/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Jasper Ji</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Jasper Ji</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">始以竹篦子久知痛痒，后因一滴水渐至澎冲。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/06/17/2021-06-17-talk-in-detail-zuohui/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/17/2021-06-17-talk-in-detail-zuohui/" class="post-title-link" itemprop="url">《详谈：左晖》读后感</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-06-17 22:33:39" itemprop="dateCreated datePublished" datetime="2021-06-17T22:33:39+08:00">2021-06-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-06 21:43:40" itemprop="dateModified" datetime="2022-07-06T21:43:40+08:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>左晖这个人要不是最近因为去世，我估计也不太知道是谁。首次听到链家，那会觉得是一家新起来的互联网的网站，感觉好像很是风口，因为挖了不少技术的牛人过去。自己那会打算买房时也专门下载了链家的APP，不过感觉那上面的房子好像偏贵。而贝壳呢？好像那会广告打的比较凶。近一两年发现，发现附近多了好多叫德佑的房产中介，最近跟一位卖房的中介聊天时才发现德佑跟贝壳的关系。作为技术人我非常好奇他是如何实现传统行业加互联网的逆袭的？因为我最近两年一直在传统企业做相关的系统，但是成效很低，所以非常想一睹左晖的思路。</p>
<p>《详谈左晖》是本不到180页的32开小册子，我大概用了2个多小时读完了此书。主要是17年和20年对左晖的访谈内容。左晖虽然从事的是传统行业，实际上他是计算机专业毕业，只不过人家没有做技术，首先做过保险，后来因为政策的缘故，改做卖房中介，链家其实很早了，2001年就创建了，虽然早期也有网站，但实际主要做线下了，链家实际是一家有着IT基因的公司，这点很关键。另一家公司就是京东，一开始是摆柜台，后来借助互联网，终成巨头。左晖一直强调传统行业在基础方面的薄弱，主要体现在战略、组织、信息化、IT方面。个人深有体会，传统的中小企业重业务，流程上比较灵活，信息化还停留在表格的阶段。</p>
<h4 id="从0到1"><a href="#从0到1" class="headerlink" title="从0到1"></a>从0到1</h4><p>左晖认为线上从0到1比较难，从1到N则相对简单。而线下则是从0到1相对简单，但是从1到N则比较难。刚好传统公司和互联网公司都待过，虽然都是些不出名的一般公司。传统公司看重的是业务，而业务很大程度跟业务员有关系，往往是一个业务模式换个打法，所以很难形成标准化的东西，或者说根本就无法形成，因为这类公司是以盈利为第一目的，所以很少长期考虑，有什么做什么，缺乏标准化的输出，这也是做大比较难的原因。而线上公司一开始就是想着一个大目标去的，所以能不能验证商业模式的成功很关键，不是线下这种有一笔业务就算一笔的事，线上的一般会比较强调标准化，而商业模式的验证则比较难，也就是所谓的从0到1。一单验证模式可行，那么规模就容易上。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>传统行业的互联化一定要紧密建立在业务环节，并且要能够利用数字以及互联网来优化或者抽象化一些细节流程，这样才能有所作为，当然也很容易变成信息化与流程的脱节问题，关键是在于落实。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/06/02/2021-06-02-first-try-webassembly/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/02/2021-06-02-first-try-webassembly/" class="post-title-link" itemprop="url">初试WebAssembly</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-06-02 20:02:53" itemprop="dateCreated datePublished" datetime="2021-06-02T20:02:53+08:00">2021-06-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-05 21:10:36" itemprop="dateModified" datetime="2022-04-05T21:10:36+08:00">2022-04-05</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>听闻WebAssembly已经有些年了，不过一直没有跑个例子尝试下。主要是使用Rust来编译生成WebAssembly的目标文件，虽然可以使用C&#x2F;C++，但想想我的Rust学习一直进展不大，不知道用在哪里，刚好Rust对WebAssembly支持也是比较详细。</p>
<h4 id="Rust问题"><a href="#Rust问题" class="headerlink" title="Rust问题"></a>Rust问题</h4><p>安装wasm-pack时提示没有安装rustup，虽然我已经哟给Brew安装了rust，最后安装rustup后就好了。</p>
<p>执行cargo install cargo-generate时，加载Crates非常慢，最后使用国内的镜像后顺利完成，这是国内镜像的配置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[source.crates-io]</span><br><span class="line">registry = &quot;https://github.com/rust-lang/crates.io-index&quot;</span><br><span class="line"># 指定镜像</span><br><span class="line">replace-with = &#x27;sjtu&#x27;</span><br><span class="line"></span><br><span class="line"># 清华大学</span><br><span class="line">[source.tuna]</span><br><span class="line">registry = &quot;https://mirrors.tuna.tsinghua.edu.cn/git/crates.io-index.git&quot;</span><br><span class="line"></span><br><span class="line"># 中国科学技术大学</span><br><span class="line">[source.ustc]</span><br><span class="line">registry = &quot;git://mirrors.ustc.edu.cn/crates.io-index&quot;</span><br><span class="line"></span><br><span class="line"># 上海交通大学</span><br><span class="line">[source.sjtu]</span><br><span class="line">registry = &quot;https://mirrors.sjtug.sjtu.edu.cn/git/crates.io-index&quot;</span><br><span class="line"></span><br><span class="line"># rustcc社区</span><br><span class="line">[source.rustcc]</span><br><span class="line">registry = &quot;https://code.aliyun.com/rustcc/crates.io-index.git&quot;</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>我在iOS的Safari试了下，也可以。虽然之前也有其他语言编译为JS的做法，所以主要解决的是如何构建大型web应用的工程问题，现在ES6的普及，好像这类方案渐渐的也不怎么提了。其他语言编译成WebAssembly的做法，主要是为解决性能的问题，把一些跟性能有关系使用WebAssembly，另外WebAssembly可以解决原来JS的老是暴露的问题。理论上其他语言都可以编译WebAssembly，但是主流的还是C&#x2F;C++、Go、Rust之类的编译为WebAssembly的方式了，不过Web开发我不是全职的那种，有需要了就写写。感觉一般Web开发者也不大会用到，有性能要求的应用可能会用到，但估计写WebAssembly估计也是领域专业的人员。</p>
<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><a target="_blank" rel="noopener" href="https://rustwasm.github.io/docs/book/introduction.html">Rust 🦀 and WebAssembly 🕸</a> ，例子主要按这个来跑的。</p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/WebAssembly">WebAssembly</a> Mozilla开发者网站关于WebAssembly的介绍，比较详细。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/06/02/2021-06-02-learning-gtk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/02/2021-06-02-learning-gtk/" class="post-title-link" itemprop="url">学习GTK</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-06-02 19:49:18 / 修改时间：16:25:03" itemprop="dateCreated datePublished" datetime="2021-06-02T19:49:18+08:00">2021-06-02</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>GTK之前有看过，还专门购买了一本关于GTK的书籍，那是主要是为了学习C的面向对象实现。现在又看GTK是因为准备购买PinePhone，主要看中了PinePhone可以运行多个Linux发行版本。现在无论是iOS还是Android都不能自由的使用喜欢的语言。作为一个曾经的iOS开发者，iOS的运行速度还真的没得说。Android因为使用Java缘故，总还是没有办法更快似乎，所以一直想着整一台Linux手机自己定制UI，不过找一台Linux手机实在是太难了，主要是目前手机都是这些公司定制的硬件，所以驱动是个大问题。</p>
<p>为什么选择GTK呢？我也看了下QT，之前也简单的使用了下，确实非常适合开发UI程序，不过授权方面还是有点问题，GTK没有这个问题。另外无论C&#x2F;C++对我来说都不是太大的问题，所以还是用GTK了。</p>
<p>考虑到主要是用来开发Linux的，所以直接在Ubuntu下跑个例子看下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdnoreturn.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdatomic.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;gtk/gtk.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;glib/gprintf.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> var</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> var __auto_type</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">PrintMsg</span><span class="params">(GtkWidget *widget, gpointer window)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span>(window != <span class="literal">NULL</span>)</span><br><span class="line">		g_printf(<span class="string">&quot;Button clicked\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	var dialog = gtk_message_dialog_new(GTK_WINDOW(window), GTK_DIALOG_MODAL | GTK_DIALOG_DESTROY_WITH_PARENT, GTK_MESSAGE_INFO, GTK_BUTTONS_OK, <span class="string">u8&quot;按钮已被按下！&quot;</span>);</span><br><span class="line">	gtk_window_set_title(GTK_WINDOW(dialog), <span class="string">u8&quot;请注意&quot;</span>);</span><br><span class="line"></span><br><span class="line">	gtk_dialog_run(GTK_DIALOG(dialog));</span><br><span class="line">	gtk_widget_destroy(dialog);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> &#123;</span><br><span class="line">	gtk_init(&amp;argc, &amp;argv);</span><br><span class="line">	var window = gtk_window_new(GTK_WINDOW_TOPLEVEL);</span><br><span class="line">	gtk_window_set_title(GTK_WINDOW(window), <span class="string">&quot;GTK Test&quot;</span>);</span><br><span class="line">	gtk_window_set_default_size(GTK_WINDOW(window), <span class="number">640</span>, <span class="number">480</span>);</span><br><span class="line">	gtk_window_set_position(GTK_WINDOW(window), GTK_WIN_POS_CENTER);</span><br><span class="line">	gtk_container_set_border_width(GTK_CONTAINER(window), <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">	var button = gtk_button_new_with_label(<span class="string">&quot;Button&quot;</span>);</span><br><span class="line">	gtk_widget_set_halign(button, GTK_ALIGN_START);</span><br><span class="line">	gtk_widget_set_valign(button, GTK_ALIGN_START);</span><br><span class="line">	gtk_widget_set_tooltip_text(button, <span class="string">&quot;This is a button widget&quot;</span>);</span><br><span class="line">	g_signal_connect(button, <span class="string">&quot;clicked&quot;</span>, G_CALLBACK(PrintMsg), window); </span><br><span class="line">	gtk_container_add(GTK_CONTAINER(window), button);</span><br><span class="line">	gtk_widget_show_all(window);</span><br><span class="line">	g_signal_connect(window, <span class="string">&quot;destroy&quot;</span>, G_CALLBACK(gtk_main_quit), <span class="literal">NULL</span>);</span><br><span class="line">	<span class="keyword">static_assert</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>) == <span class="number">4</span>, <span class="string">&quot;Not compatible architecture!&quot;</span>);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Will enter GTK runloop...&quot;</span>);</span><br><span class="line">	gtk_main();</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;Program terminated!&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/include/pango-1.0/pango/pango-coverage.h:28:10: fatal error: &#x27;hb.h&#x27; file not found</span><br></pre></td></tr></table></figure>
<p>解决方案运行<code>pkgconf --cflags harfbuzz</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/ld: cannot find -lBlocksRuntime</span><br></pre></td></tr></table></figure>
<p>解决方案运行<code>sudo apt-get install libblocksruntime-dev</code></p>
<h4 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang main.c -std=gnu11 -fblocks -lBlocksRuntime -I/usr/include/glib-2.0/ -I/usr/include/atk-1.0/ -I/usr/include/gdk-pixbuf-2.0/ -I/usr/include/cairo/ -I/usr/include/pango-1.0/ -I/usr/lib/x86_64-linux-gnu/glib-2.0/include/ -I/usr/include/gtk-3.0/ -I /usr/include/harfbuzz/ -L/usr/lib/x86_64-linux-gnu/ -lgtk-3 -lgobject-2.0 -lpangocairo-1.0 -lgio-2.0 -latk-1.0 -lgdk-3 -lglib-2.0    -o gtk-test</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>GTK开发确实比较麻烦，后续还的配置个好的IDE环境，不过想想要求的OC开发，其实对于C还是蛮亲切的。其实一旦涉及真实项目，更多都是对框架的学习了，先挖个坑。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/05/27/2021-05-27-monk-rujing-quotes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/27/2021-05-27-monk-rujing-quotes/" class="post-title-link" itemprop="url">如净和尚语录</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-05-27 11:33:27" itemprop="dateCreated datePublished" datetime="2021-05-27T11:33:27+08:00">2021-05-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-09-16 20:27:57" itemprop="dateModified" datetime="2022-09-16T20:27:57+08:00">2022-09-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="缘起"><a href="#缘起" class="headerlink" title="缘起"></a>缘起</h4><p>没有去天童寺之前我就在网上阅读了《如净和尚语录》，后来就想着有没有纸质版的，刚好去天童寺的时候，我请了一本，是线装繁体竖排本，发现很多字不知道读音，有点阅读困难，另外携带也不太方便，因为是16开的。后来在孔夫子网上淘到了一本应该自己印刷的带拼音的简体版本，而且还是32开的。那段时间经常拿着在地铁上读，确实让我读进去了一些内容，不过不足的是发现里面居然缺少了大概两页的内容，另外有些无法打出来的字体直接用问号显示。于是就有想自己编辑一本带拼音的繁体版本，虽然不到一百页的内容，实际整理的时间也差不多有半个月时间，前后又反复的阅读修正了一些错误。当时想着再印刷出来，不过实际上到现在也没有印刷出来，这个版本的PDF非常适合在手机上阅读，所以也觉得没有必要印刷出来了。</p>
<p>《如净和尚语录》注音版我在Github上建了个项目，并把PDF文件放在了方面，有兴趣的可以拉下来读读。<a target="_blank" rel="noopener" href="https://github.com/jasper2007111/tiantong-rujing">项目地址</a></p>
<h4 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h4><p>后来那本32开的小册子在去年去郑州出差的时候，走的太急，落在了场子里面，希望有缘人能得到。我自己整理的这个PDF注音版本现在也经常在手机偶尔看看。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/05/04/2021-05-04-thinking-about-rss/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/04/2021-05-04-thinking-about-rss/" class="post-title-link" itemprop="url">关于RSS的思考</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-05-04 13:55:13" itemprop="dateCreated datePublished" datetime="2021-05-04T13:55:13+08:00">2021-05-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-05 11:38:20" itemprop="dateModified" datetime="2021-05-05T11:38:20+08:00">2021-05-05</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="缘起"><a href="#缘起" class="headerlink" title="缘起"></a>缘起</h4><p>17年的时候为了练习Swift，也想验证下自己对于产品方面的想法，当时流行的应用都是通过爬虫抓取内容网站的数据，清洗数据后再通过推荐引擎展示给用户，当时我们公司也做的是这类应用，只不过后来没有成功。作为练手的业余项目，我并没有打算也做类似的项目，那会我主要做iOS客户端，对于服务端也不是很在行，而且当时这类应用有个问题是，你需要搜集大量的内容网站，可这一定是用户喜欢的吗？当时想关于用户喜欢什么样的内容让用户自己去找吧，而我只提供一个工具，最后选定了RSS阅读器。在App Store上找了一些RSS应用调研，很多应用是国外人开发的，交互上不太符合国人的习惯，另外不少应用需要注册后才能使用，当然有些还是付费的。觉得还是有改进的空间的，目标是开发一款简单的应用，首先不需要登录注册之类的，用户添加自己的RSS源，然后拉取数据，展示详情，最后这是一款免费的应用。很快这款应用就被开发出来上线了，过了段时间我看了下数据，有不少用户评价，之前的应用用户很少评价，我一直觉得用户能评价应用很难，至少我自己都很少评价了。用户多半是通过搜索下载的，这让我想到了长尾效应，即使如此小众的应用，总有它的用户群体。</p>
<h4 id="瓶颈"><a href="#瓶颈" class="headerlink" title="瓶颈"></a>瓶颈</h4><p>经过一年多的更新，应用基本上算是稳定了，18年底后就没有再更新过了，一方面工作有些变化，之前公司的新闻类应用已经不再运营了。而我也做了一年多的Unity游戏应用，iOS开发实际上很少了，之后离开了原来的公司。短暂的停留后，开始到现在的公司做服务器方面的开发，iOS的开发者账号也在到期后没有再续，一方面我想试下，如果账号不续费，应用还在商店吗？当然最主要的是，工作太忙iOS已经很久都不弄了，对于RSS阅读器应用，也没有更好的想法。最后每年花着钱，却没有一分的收入，这可能对于做一款免费应用者或多或少的有点失落吧，毕竟需要生活。苹果账号没有续费后，应用结果就被下架了。大概一年的时间，我没有再想关于苹果开发的事。</p>
<h4 id="重启"><a href="#重启" class="headerlink" title="重启"></a>重启</h4><p>21年四月份的时候，我又把苹果账号给续费了，在做企业应用的一年里，发现相比行业的复杂性，个人应用似乎更能好把握些吧。另外作为一个软件开发者，很大程度是依赖于工作的，工作上我们可以沉迷于技术的细节，但从宏观上来看，至少这么些年做的应用都是商业上的不成功吧，当然作为开发者很难去左右这个结果。而作为App Store的独立开发者可以很大程度上让自己在整个从产品的构想到设计，开发，到最后的营销及运营，都能有很大的锻炼。对于开发人员而言，App Store依旧施展自己创意和想法的最好平台。</p>
<p>于是我决定继续RSS阅读器的开发，iOS 13启用夜间模式后，之前的应用确实一些问题，新版本主要是适配夜间模式，之前有用户也提到是否可以开发夜间模式的显示，不过一直没有启动。因为界面比较少很快也就适配完了，内容显示那块我也学习到了如何使用CSS适配夜间模式。</p>
<p>另外做了一个决定新版本将只支持iOS 13以上的版本，夜间模式和Swift UI都只能在iOS 13以上的版本使用，只想专注在功能的开发上，而不是兼容上。我自己的iPhone 6s都已经升级到iOS 14了，所以这个决定也是有一定的依据的。</p>
<h4 id="未来"><a href="#未来" class="headerlink" title="未来"></a>未来</h4><p>关于RSS阅读器，我依旧没有更好的想法，实际上在新版本中我又去掉了几个已经失效的RSS源，而有些RSS源已经很久没有更新了。我一度想再找一些不错的源，可发现真的很难，很多都是好几年前的帖子，所以RSS阅读器的前景并不乐观，这是一块正在极速萎缩的市场，而很多开发者估计会放弃，更不可能成为一款公司的产品存在。难怪早在2012的时候谷歌就关闭了RSS阅读应用Google Reader。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/05/02/2021-05-02-octopress-upgrade/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/02/2021-05-02-octopress-upgrade/" class="post-title-link" itemprop="url">Octopress升级</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-05-02 00:15:59 / 修改时间：00:53:58" itemprop="dateCreated datePublished" datetime="2021-05-02T00:15:59+08:00">2021-05-02</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>升级其他软件的时候居然把Ruby版本升级到了3.0，而Octopress依赖的Jekyll的版本是2.0，对Ruby版本有限制，新版本用不了。本来想换个静态博客的框架来着，想着自己好歹也是全栈工程师，自己升级下吧。</p>
<p>Octopress其实是基于Jekyll的定制静态博客框架，生成静态内容主要依赖于Jekyll了。看了下Jekyll已经到4.0了，干脆直接升级到4.0了。不过发现一些问题，4.0后放弃了对RDiscount、Pygments的支持，默认的Markdown解析用的是Kramdown。Octopress分别使用了RDiscount、Pygments，所以这块只能弃用了，改用Kramdown。</p>
<p>升级后发现代码高亮有点问题，4.0因为弃用了Pygments，所以只能使用默认的Rouge。Octopress自己实现了一个代码高亮的样式，但是有兼容问题，最后直接弃用。使用Rouge生成Github的样式，最后修改了下，最终变成现在的样子，总之还是不太喜欢之前的暗背景的样式。</p>
<p>生成文章方面，因为Jekyll的一些变更，遇到三个问题，首先是文章列表是生序排序的，修改了下也好了。其次发现首页没有文章，主要是没有安装jekyll-paginate的缘故。最后就是生成的文章没有时间，Octopress自定义了一个时间格式的钩子，但是没有起作用，最后直接使用原生的方式解决了。</p>
<p>博客预览使用<code>rake preview</code>会报错，最后直接在Public目录下起了个Python的Web服务器，这个并不影响使用。 </p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>现在还在用Octopress人确实不多了，多半都是不更新的僵尸博客了。其实这些静态博客解决方案原理大同小异的，之前有人吐槽Octopress生成博客文章慢，实际上主要是Jekyll慢了，不过现在都4.0了，目前我觉得速度还是能接受的。</p>
<p>既然Octopress作者都不维护了，想着后续问题修复的差不多了，把修改的版本放出了，也算是尽一份力吧。</p>
<p>参考:<br><a target="_blank" rel="noopener" href="https://jekyllrb.com/news/2019/08/20/jekyll-4-0-0-released/">Jekyll 4.0.0 Released</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/04/26/2021-04-26-talk-about-meditatio/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/26/2021-04-26-talk-about-meditatio/" class="post-title-link" itemprop="url">谈谈冥想</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-26 23:06:57" itemprop="dateCreated datePublished" datetime="2021-04-26T23:06:57+08:00">2021-04-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-27 15:22:21" itemprop="dateModified" datetime="2021-05-27T15:22:21+08:00">2021-05-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>坚持冥想已经有六七年了，略有点经验与大家分享下，一家之言，只供参考。</p>
<h4 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h4><p>冥想多长时间比较好？我目前是30分钟，之前一段时间都是1个小时，改成30分钟是因为后来找的工作太远，个人建议不低于30分钟为好。</p>
<p>什么时间冥想比较好？我是早上冥想了，下午很少冥想。首先早上精神比较好，不容易发困，下午冥想的时候往往劳累一天状态不是很好。早上冥想是因为时间比较好安排，只要你起的早，时间都是可以挪出来的。</p>
<h4 id="姿势"><a href="#姿势" class="headerlink" title="姿势"></a>姿势</h4><p>首推双盘，其次单盘，最不好散盘。能单盘不要散盘，能双盘不要单盘。单盘基本上大家都可以，双盘如果身体不够瘦或者腿实在太硬，还是有点难度的。不过双盘只是时间问题了，我单盘五年一直双盘不上，基本上都已经放弃对双盘的想法，不过五年后的某天我居然可以双盘了，所以现在觉得双盘这个只是时间的问题，可能每个人不太一样，不过就是不要太主观的设置一个时间点，顺其自然就好，功夫到了自然盘的上。</p>
<p>双盘和单盘冥想有什么差别，进入状态后其实差别不大，不过双盘确实比较稳。双盘比较难，很大程度是因为在一开始不熟练的情况下，疼痛会干扰到无法安心坐下去。双盘我目前采用先盘左腿，再盘右腿的吉祥坐，另外手印也采用右手放在左手掌的方式，目前自我感觉这样的姿势可以很好的安心双盘。</p>
<p>调身，总的来说身体瘦一点，下午少吃点，对于盘腿还是有帮助的。我断食21天时，双盘完全不是问题，所以还是不要自己太胖。</p>
<h4 id="观呼吸"><a href="#观呼吸" class="headerlink" title="观呼吸"></a>观呼吸</h4><p>干坐着，心可能会更乱，一般人都会觉得坐不了多久，自己就想不坐了。我早期接触的时候，也是不得其法，一开始就那样坐着，时间比较短。后来去了禅寺的禅堂坐了几次香（打坐），下午香时间最长一个半小时，当时还是散盘，到最后腿巨痛，虽然坚持了下来，后来问一个坐的比较好的小姑娘，原来她在用数呼吸，我也学着使用这个方式。数呼吸，一呼一吸算一下，从1到10，重复，实际上比较难，你会发现你的心会莫名的飞出个念头，打乱数呼吸的节奏。不过你只要持续的数，专注了，我当时觉得时间一下子变短了，腿也不痛了，所以数呼吸对于摄心还是很有效果了。结果一数就是到现在了，关于数呼吸详细的内容可以参阅南传佛教的典籍《清静道论》。</p>
<h4 id="心态"><a href="#心态" class="headerlink" title="心态"></a>心态</h4><p>不管什么原因让你开始冥想，但不要对冥想有一个心理期许，放长远一点，用余生去练习，每个阶段你能收获什么取决于你走的有多远，而多远不是你主观可以预判的。虎头蛇尾的冥想我也见过几个，其实冥想对我而言更多获得了一种内心的平静，而我觉得这就够了。但很多人，不是这样想的，期许太多，最终没有能坚持下来。坚持冥想，全身心的投入到工作，让冥想成为一种习惯，不要太热衷，也不要太懈怠。</p>
<h4 id="书籍"><a href="#书籍" class="headerlink" title="书籍"></a>书籍</h4><p>最好的依旧是坚持练习，少看书，偶尔看一点就可以了，多了反而是障碍。偏方法的推荐《清静道论》或者南传佛教相关的书籍，不过《清静道论》是根本。心态类的推荐《禅者的初心》，心态要对，这很关键。</p>
<h4 id="如何开始？"><a href="#如何开始？" class="headerlink" title="如何开始？"></a>如何开始？</h4><p>去禅寺的禅堂学习冥想是我走过的路，正规的禅寺有一套很完备的机制，让你短时间内可以上路。不过很多人在禅寺的时候可以冥想，但出了禅寺就不行了，总是找各种理由。禅寺只是开始的地方，冥想之路才刚开始。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/04/26/2021-04-26-springboot-elasticsearch/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/26/2021-04-26-springboot-elasticsearch/" class="post-title-link" itemprop="url">Spring Boot使用Elasticsearch</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-04-26 05:23:43 / 修改时间：10:41:34" itemprop="dateCreated datePublished" datetime="2021-04-26T05:23:43+08:00">2021-04-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>主要是想把Elasticsearch整合到当前的系统中，用来搜索文章。</p>
<h4 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h4><p><em>Elasticsearch 7.12.0</em><br><em>Logstash 7.12.0</em><br><em>Mysql 8.0</em>  </p>
<h4 id="数据同步"><a href="#数据同步" class="headerlink" title="数据同步"></a>数据同步</h4><p>把Elasticsearch整合到现有系统意味需要把当前要搜索的数据添加到Elasticsearch里面，这就有个数据同步问题。因为是测试工程使用的是Logstash的全量数据同步。Logstash的新版本已经包含了Jdbc的插件，所以不需要安装。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">  jdbc &#123;</span><br><span class="line">      # myslq驱动，可以官网下载，我用的是Maven依赖已经下载的Jar文件</span><br><span class="line">      jdbc_driver_library =&gt; &quot;&quot;</span><br><span class="line">      # Mysql驱动类全类名，注意mysql8.x以上需要加cj</span><br><span class="line">      jdbc_driver_class =&gt; &quot;com.mysql.cj.jdbc.Driver&quot;</span><br><span class="line">      # mysql连接url</span><br><span class="line">      jdbc_connection_string =&gt; &quot;&quot;</span><br><span class="line">      # mysql 用户名</span><br><span class="line">      jdbc_user =&gt; &quot;&quot;</span><br><span class="line">      # mysql 密码</span><br><span class="line">      jdbc_password =&gt; &quot;&quot;</span><br><span class="line">      # 设置定时任务，多久执行一次查询，默认一分钟，需要无延迟可使用schedule =&gt; &quot;* * * * * *&quot;</span><br><span class="line">      schedule =&gt; &quot;* * * * *&quot;</span><br><span class="line">      # 清空上次的sql_last_value记录</span><br><span class="line">      clean_run =&gt; true</span><br><span class="line">      # 要执行的sql（同步）语句，替换成你自己的sql</span><br><span class="line">      statement =&gt; &quot;SELECT * FROM t_article&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output &#123;</span><br><span class="line">   elasticsearch &#123;</span><br><span class="line">      # es主机和端口</span><br><span class="line">      hosts =&gt; [&quot;127.0.0.1:9200&quot;]</span><br><span class="line">      # 同步数据在ES的索引名称，替换为你自己的。</span><br><span class="line">      index =&gt; &quot;my-cms&quot;</span><br><span class="line">      # es文档的id，表示使用mysql表的id</span><br><span class="line">      document_id =&gt; &quot;%&#123;id&#125;&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>生产环境的数据同步可以参考<a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/146038.html?spm=a2c4g.11186623.6.784.8fe41c61aTodOu">阿里云Elasticsearch</a></p>
<p>参考:<br><a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/logstash/current/plugins-inputs-jdbc.html">Jdbc input plugin</a></p>
<h4 id="Spring-Boot配置"><a href="#Spring-Boot配置" class="headerlink" title="Spring Boot配置"></a>Spring Boot配置</h4><p>添加Maven依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-elasticsearch<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>添加Elasticsearch客户端配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableElasticsearchRepositories(basePackages = &quot;io.pratik.elasticsearch.repositories&quot;)</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackages = &#123; &quot;io.pratik.elasticsearch&quot; &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ElasticsearchClientConfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractElasticsearchConfiguration</span> &#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="keyword">public</span> RestHighLevelClient <span class="title function_">elasticsearchClient</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="comment">// 配置连接信息</span></span><br><span class="line">		<span class="keyword">final</span> <span class="type">ClientConfiguration</span> <span class="variable">clientConfiguration</span> <span class="operator">=</span> ClientConfiguration.builder().connectedTo(<span class="string">&quot;localhost:9200&quot;</span>)</span><br><span class="line">				.build();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> RestClients.create(clientConfiguration).rest();</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 这个很重要，不添加的话无法使用<span class="doctag">@Filed</span>注解</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> EntityMapper <span class="title function_">entityMapper</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ElasticsearchEntityMapper</span> <span class="variable">entityMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ElasticsearchEntityMapper</span>(</span><br><span class="line">                elasticsearchMappingContext(), <span class="keyword">new</span> <span class="title class_">DefaultConversionService</span>()</span><br><span class="line">        );</span><br><span class="line">        entityMapper.setConversions(elasticsearchCustomConversions());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> entityMapper;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试文章类，必须要加<code>type=&#39;_doc&#39;</code>，不然无法使用。另外遇到的问题是我数据库的日期用的是<code>Date</code>话，一直提示解析错误，最后使用<code>LocalDateTime</code>后就好了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Document(indexName = &quot;my-cms&quot;, type = &quot;_doc&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EsArticle</span> &#123;</span><br><span class="line">	<span class="meta">@Id</span> <span class="comment">// org.springframework.data.annotation.Id</span></span><br><span class="line">	<span class="keyword">private</span> Integer id; <span class="comment">// 文章ID</span></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Field(type = FieldType.Text, analyzer = &quot;ik_max_word&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String title; <span class="comment">// 文章标题</span></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Field(name = &quot;content&quot;, type = FieldType.Text, analyzer = &quot;ik_max_word&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String articleContent; <span class="comment">// 文章正文内容</span></span><br><span class="line"></span><br><span class="line">	<span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line">	<span class="meta">@Field(name = &quot;create_time&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> LocalDateTime createTime; <span class="comment">// 文章创建时间</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建<code>Repository</code>类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ElasticArticleRepository</span> <span class="keyword">extends</span> <span class="title class_">ElasticsearchRepository</span>&lt;EsArticle, Integer&gt; &#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>生成<code>Controller</code>，使用<em>Postman</em>测试接口是否正常工作。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/article&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SearchController</span> &#123; </span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ElasticArticleRepository elasticRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/search&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;EsArticle&gt; <span class="title function_">handleSearchRequest</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam</span> Map&lt;String, Object&gt; requestParam)</span> &#123;</span><br><span class="line">        <span class="type">BoolQueryBuilder</span> <span class="variable">queryBuilder</span> <span class="operator">=</span> QueryBuilders.boolQuery();</span><br><span class="line">        <span class="comment">// 构造ES查询条件</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">keyword</span> <span class="operator">=</span> (String) requestParam.get(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">        queryBuilder.should(QueryBuilders.matchPhraseQuery(<span class="string">&quot;title&quot;</span>, keyword))</span><br><span class="line">                .should(QueryBuilders.matchPhraseQuery(<span class="string">&quot;content&quot;</span>, keyword));</span><br><span class="line"> </span><br><span class="line">        <span class="type">StopWatch</span> <span class="variable">watch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StopWatch</span>();</span><br><span class="line">        watch.start(); <span class="comment">// 开始计时</span></span><br><span class="line"> </span><br><span class="line">        Page&lt;EsArticle&gt; articles = (Page&lt;EsArticle&gt;)</span><br><span class="line">                elasticRepository.search(queryBuilder);  <span class="comment">// 检索数据</span></span><br><span class="line"> </span><br><span class="line">        watch.stop();  <span class="comment">// 结束计时</span></span><br><span class="line">        System.out.println(String.format(<span class="string">&quot;数据检索耗时：%s ms&quot;</span>,</span><br><span class="line">                watch.getTotalTimeMillis()));</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> articles.getContent();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/04/23/2021-04-23-springboot-elk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/23/2021-04-23-springboot-elk/" class="post-title-link" itemprop="url">Spring Boot使用ELK</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-23 08:31:23" itemprop="dateCreated datePublished" datetime="2021-04-23T08:31:23+08:00">2021-04-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-01 01:04:21" itemprop="dateModified" datetime="2021-05-01T01:04:21+08:00">2021-05-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>是在Mac环境下跑的例子。</p>
<h4 id="安装ELK相关软件"><a href="#安装ELK相关软件" class="headerlink" title="安装ELK相关软件"></a>安装ELK相关软件</h4><p>ELK主要指Elasticsearch、Logstash、Kibana，使用<code>elastic.co</code>提供的安装指南，使用Brew安装。</p>
<p>切换Tab</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew tap elastic/tap</span><br></pre></td></tr></table></figure>

<p>安装软件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">brew install elastic/tap/elasticsearch-full  <span class="comment"># 安装Elasticsearch</span></span><br><span class="line">brew install elastic/tap/logstash-full <span class="comment"># Logstash</span></span><br><span class="line">brew install elastic/tap/kibana-full <span class="comment"># Kibana</span></span><br></pre></td></tr></table></figure>

<p>可以在前台或者后台启动软件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">brew services start elastic/tap/elasticsearch-full <span class="comment"># 后台启动</span></span><br><span class="line">elasticsearch <span class="comment"># 前台启动</span></span><br><span class="line"></span><br><span class="line">brew services start elastic/tap/logstash-full</span><br><span class="line">logstash</span><br><span class="line"></span><br><span class="line">brew services start elastic/tap/kibana-full</span><br><span class="line">kibana</span><br></pre></td></tr></table></figure>

<h4 id="Spring-Boot配置"><a href="#Spring-Boot配置" class="headerlink" title="Spring Boot配置"></a>Spring Boot配置</h4><p>Maven添加Logstash依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.logstash.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logstash-logback-encoder<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在Resources目录下添加<code>logback-spring.xml</code>配置文件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;include resource=<span class="string">&quot;org/springframework/boot/logging/logback/base.xml&quot;</span> /&gt;</span><br><span class="line">    &lt;appender name=<span class="string">&quot;LOGSTASH&quot;</span> class=<span class="string">&quot;net.logstash.logback.appender.LogstashTcpSocketAppender&quot;</span>&gt;</span><br><span class="line">    	&lt;!-- 配置输出地址 --&gt;</span><br><span class="line">        &lt;destination&gt;127.0.0.1:4560&lt;/destination&gt;</span><br><span class="line">        &lt;!-- 日志输出编码 --&gt;</span><br><span class="line">        &lt;encoder charset=<span class="string">&quot;UTF-8&quot;</span></span><br><span class="line">                class=<span class="string">&quot;net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder&quot;</span>&gt;</span><br><span class="line">            &lt;providers&gt;</span><br><span class="line">                &lt;timestamp&gt;</span><br><span class="line">                    &lt;timeZone&gt;UTC&lt;/timeZone&gt;</span><br><span class="line">                &lt;/timestamp&gt;</span><br><span class="line">                &lt;pattern&gt;</span><br><span class="line">                    &lt;pattern&gt;</span><br><span class="line">                        &#123;</span><br><span class="line">                        <span class="string">&quot;logLevel&quot;</span>: <span class="string">&quot;%level&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;serviceName&quot;</span>: <span class="string">&quot;<span class="variable">$&#123;springAppName:-&#125;</span>&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;pid&quot;</span>: <span class="string">&quot;<span class="variable">$&#123;PID:-&#125;</span>&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;thread&quot;</span>: <span class="string">&quot;%thread&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;class&quot;</span>: <span class="string">&quot;%logger&#123;40&#125;&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;rest&quot;</span>: <span class="string">&quot;%message&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &lt;/pattern&gt;</span><br><span class="line">                &lt;/pattern&gt;</span><br><span class="line">            &lt;/providers&gt;</span><br><span class="line">        &lt;/encoder&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">    &lt;root level=<span class="string">&quot;INFO&quot;</span>&gt;</span><br><span class="line">        &lt;appender-ref ref=<span class="string">&quot;LOGSTASH&quot;</span> /&gt;</span><br><span class="line">        &lt;appender-ref ref=<span class="string">&quot;CONSOLE&quot;</span> /&gt;</span><br><span class="line">    &lt;/root&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<p>配置Logstash，创建一个<code>logstash-sample.conf</code>文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">  tcp &#123;</span><br><span class="line">    mode =&gt; &quot;server&quot;</span><br><span class="line">    host =&gt; &quot;0.0.0.0&quot;</span><br><span class="line">    port =&gt; 4560</span><br><span class="line">    codec =&gt; json</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">output&#123;</span><br><span class="line">  elasticsearch &#123;</span><br><span class="line">     hosts =&gt; [&quot;http://localhost:9200&quot;] # Elasticsearch 地址</span><br><span class="line">     index =&gt; &quot;spring_cms-%&#123;+YYYY.MM.dd&#125;&quot; # 这里我用spring_cms，可以替换为自己的。需要注意ES关于索引的命名规范</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用配置文件重启Logstash服务</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logstash  -f logstash-sample.conf</span><br></pre></td></tr></table></figure>

<p>最后在项目中输出一段测试日志</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logger.info(<span class="string">&quot;Hello，ELK&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>最后在Kibana创建索引就应该能看到日志了。</p>
<h4 id="额外工具"><a href="#额外工具" class="headerlink" title="额外工具"></a>额外工具</h4><p>一开始发现Kibana中没有数据，猜测Elasticsearch没有收到数据，最后用到了<a target="_blank" rel="noopener" href="https://github.com/mobz/elasticsearch-head">ElasticSearch head</a>这个可以查看Elasticsearch存储的工具，具体安装可以参考Github的说明。</p>
<p>运行这个工具遇到问题，发现ElasticSearch连接不上，原来是跨域访问的问题，使用brew安装ElasticSearch后会有如下目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Data:    /usr/local/var/lib/elasticsearch/elasticsearch_xxxx/ # xxxx此处是你自己的电脑名</span><br><span class="line">Logs:    /usr/local/var/log/elasticsearch/elasticsearch_xxxx.log # xxxx此处是你自己的电脑名</span><br><span class="line">Plugins: /usr/local/var/elasticsearch/plugins/</span><br><span class="line">Config:  /usr/local/etc/elasticsearch/</span><br></pre></td></tr></table></figure>

<p>编辑配置文件<code>nano /usr/local/etc/elasticsearch/elasticsearch.yml</code>，添加如下配置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http.cors.enabled: true</span><br><span class="line">http.cors.allow-origin: &quot;*&quot;</span><br></pre></td></tr></table></figure>
<p>最后就可以正常访问了。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>使用ELK访问日志确实很方便，实际开发中可能会使用云服务商提供ELK服务。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/04/19/2021-04-19-learn-docker-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/19/2021-04-19-learn-docker-2/" class="post-title-link" itemprop="url">学习Docker使用二</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-04-19 06:01:29 / 修改时间：15:33:32" itemprop="dateCreated datePublished" datetime="2021-04-19T06:01:29+08:00">2021-04-19</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>打包现有Java工程的Jar到Docker镜像，也是遇到了问题。</p>
<h4 id="不熟悉Dockerfile"><a href="#不熟悉Dockerfile" class="headerlink" title="不熟悉Dockerfile"></a>不熟悉Dockerfile</h4><h6 id="COPY-源-目标"><a href="#COPY-源-目标" class="headerlink" title="COPY 源 目标"></a>COPY 源 目标</h6><p>一开始把源和目标的顺序给弄反了，但是还在镜像中有那个文件，结果执行<code>java -jar xxx.jar</code>老提示<code>Error: Unable to access jarfile xxx.jar</code>。最后登录到容器内部发现jar的文件大小不对，最后才反应过来把顺序弄反了。</p>
<h4 id="登入容器内部"><a href="#登入容器内部" class="headerlink" title="登入容器内部"></a>登入容器内部</h4><p>一开始为了诊断Java运行Jar文件不成功的问题，我就想看看容器内的文件是否已经在。最后用如下命令，登入容器，这个还是比较有用，不过应该去掉镜像的<code>CMD</code>命令。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -t -i xxx_container /bin/bash</span><br></pre></td></tr></table></figure>

<h4 id="镜像大小"><a href="#镜像大小" class="headerlink" title="镜像大小"></a>镜像大小</h4><p>一开始用的<code>FROM openjdk:8</code>，打出的镜像有800多M，后来使用<code>FROM openjdk:8-jdk-alpine</code>，大小150多M，我的Jar包实际只有不到50M的样子，所以还是比较大了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jasper Ji</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">66</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jasper Ji</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
