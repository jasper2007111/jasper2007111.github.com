<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"c2lang.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Jasper Ji">
<meta property="og:url" content="https://c2lang.com/index.html">
<meta property="og:site_name" content="Jasper Ji">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Jasper Ji">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://c2lang.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Jasper Ji</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Jasper Ji</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">始以竹篦子久知痛痒，后因一滴水渐至澎冲。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2022/04/05/webAssembly-reverie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/05/webAssembly-reverie/" class="post-title-link" itemprop="url">WebAssembly 遐想</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-04-05 21:06:10 / 修改时间：22:21:41" itemprop="dateCreated datePublished" datetime="2022-04-05T21:06:10+08:00">2022-04-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>上次去省图偶然看到了《WebAssembly 实战》一书，之前就有关注到，于是就借了回来，刚好趁清明假期看看。之前有写过一篇<a href="https://c2lang.com/2021/06/02/2021-06-02-first-try-webassembly/">《初试WebAssembly》</a>，本身Rust语言不熟，虽然我买了本《Rust权威指南》，但一直没有什么项目可以练手，基本上没有进展。《WebAssembly 实战》一书是基于C&#x2F;C++的，相对来说读起来障碍不大。实际我也跑了一个例子试了下，当然如果真拿C&#x2F;C++来写Web应用的话，估计会很奔溃了。接着我又看了好几个关于WebAssembly的视频演讲，发现有了新的想法。</p>
<p>推出WebAssembly这个东西主要是因为现有的优化已经无法满足性能的进一步提升了，语言肯定不能大改了，JS这么用的广。记得早些年使用Flash的时候，那会是在嵌入式上跑AS2，性能的问题真的是让我当时无语。后来又推出了AS3性能又大幅的提升，但是很长一段时间，我们公司的引擎没有升级，所以我基本上还是用AS2。虽然现在的Web开发没有像当年那样，毕竟开放的环境还是不一样。回到正题，如果单纯的写WebAssembly的话，好像也没有这个必要，而且据说和JS的调用开销不小，所以到底什么时候用，是个问题。反过来想要是哪天整个的Web可以大部分都用WebAssembly来写的话，那就好了，不过目前还不能直接操作Dom，这是一个很大的问题，理论和JS是相互调用的，我看到Rust有个web_sys的库，可以操作dom，不过我想应该也是自己实现的吧。目前看到几个Rust的例子，是直接用WebAssembly来写整个的Web应用的，比如Yew这个Rust的框架允许你构建基于WebAssembly的应用。</p>
<p>所以如果和JS混着用，那么实际上是把WebAssembly作为一个计算密集型的一个解决方案吧，实际开发中大部分的Web应用都是些轻客户端，主要还是界面相关的操作了，其实大部分情况下很难想到用WebAssembly了，这也是我最早尝试时的感想。但是如果未来解决了类似调DOM的成本比较高的的问题，那么有没有可能Web语言变成Rust为主，为什么是Rust呢？首先WebAssembly本身没有垃圾回收，内存是手动处理了。Rust呢？标榜的是一个没有垃圾回收的安全语言，与C&#x2F;C++相比实际上是语言层面上处理内存管理的问题。这么一想Rust与WebAssembly真是绝配，当然其他的语言也可以编译成WebAssembly，但对于垃圾回收的语言，是比要实现一个垃圾回收的运行时环境，这样性能上就会有折扣。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>想来想去，最终落到Rust这个语言上了，或者说WebAssembly本身的设计这种在底层改变的东西无疑为未来提供了各种改变的可能性，即使不是Rust也许会是其他的语言。C&#x2F;C++用户可以让现有的库移植到Web上使用，另外Web应用一定是现在这样的轻客户端的类型吗？WebAssembly的引入确实提供另一种可能。另外一定要用JS来写Web应用吗？过去是没有办法，但是底层的改变让未来可以使用统一基于WebAssembly的语言来写Web成为了可能，而不像过去所有新的语言实际上都得编译成JS。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2022/03/28/blog-migration-to-hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/28/blog-migration-to-hexo/" class="post-title-link" itemprop="url">博客迁移到Hexo</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-28 21:31:46" itemprop="dateCreated datePublished" datetime="2022-03-28T21:31:46+08:00">2022-03-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-02 13:44:22" itemprop="dateModified" datetime="2022-04-02T13:44:22+08:00">2022-04-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本站14年建立的，那会Octopress确实流行，好多的技术大拿都用，可惜当时只是建了个站，就没有写东西，后来想写东西了，发现大家都不用Octopress了，有人说慢，其实我的电脑上还行。一开始我也没有想着换，Octopress的问题是作者已经不更新了，所以就有一堆的升级的问题，总之对于程序员而言也无所谓，改改还是可以用的，就这样一直坚持到写这篇文章的晚上。</p>
<p>我比较在意代码高亮，上次就把Octopress的代码高亮给改了，不过不完美。其实博客很大程度是我的一些技术的记录了，想想这个，就一时兴起尝试的迁移吧。虽然静态博客框架很多，不过自己最近3年一直有写JS，另外Hexo确实很多人用。这次的迁移可以说相当的顺利。Hexo的文档非常不错，基本上照着来网站就好了。原来想着在Github再建一个项目，后来发现不需要，直接把我旧的网站一覆盖就可以了。</p>
<p>使用的主题是NexT，我比较喜欢简洁的，这个主题的文档也非常不错，很快就搞定了，看着焕然一新的博客，Octopress已成过去时了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2022/03/24/2022-03-24-gitlab-upgrade/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/24/2022-03-24-gitlab-upgrade/" class="post-title-link" itemprop="url">Gitlab升级</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-24 09:32:07" itemprop="dateCreated datePublished" datetime="2022-03-24T09:32:07+08:00">2022-03-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-25 11:47:58" itemprop="dateModified" datetime="2022-03-25T11:47:58+08:00">2022-03-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>我安装的是13.0.4的版本，20年安装的，当时也没有想到要升级，觉得小团队用。但是自从去年被病毒入侵后，在反反复复的杀病毒后，病毒还是不断的重来，严重的影响了开发。</p>
<p>Gitlab的升级不能直接跨版本升级，需要一步步的来。可以参考<a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/update/index.html#upgrade-paths">官方升级路线</a>。我的版本是13.0.4，官方的路线<code>13.0.14 -&gt; 13.1.11 -&gt; 13.8.8 -&gt; 13.12.15 -&gt; 14.0.12 -&gt; latest 14.Y.Z</code>，我原来想着是不是需要先升级到13.0.14，按一般的管理，最后这个应该是布丁版本了，实际是直接升级13.1.11就可以了，装完后再安装13.8.8，以此类推。</p>
<p>Gitlab的各个版本的镜像地址<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/">清华大学开源软件镜像站</a>，速度还是非常给力。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>对于Gitlab这类软件，还是要定期升级的，不然就版本的漏洞导致的瘫痪实在是划不来。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2022/03/17/2022-03-17-clean-up-linux-viru/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/17/2022-03-17-clean-up-linux-viru/" class="post-title-link" itemprop="url">清理Linux病毒</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-03-17 10:08:48 / 修改时间：10:46:54" itemprop="dateCreated datePublished" datetime="2022-03-17T10:08:48+08:00">2022-03-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h4><p>Windows上中毒已经习以为常，但是Linux中毒，之前没有遇到过。之前写过一篇<a href="https://c2lang.com/blog/2021/11/12/remembering-a-gitlab-failure/">《记Gitlab一次故障》</a>，当时以为Gitlab服务器就好了，后来发现还是会时不时的就访问不了，CPU还是占的满满的，想着是不是要降低Gitlab的配置，最后把配置降低后，CPU还是满满的，我一度想换个Gitlab类似的东西，直到我发现即使把Gitlab停止后，依旧有两个Git的用户的程序把CPU占的满满的。其中一个叫kthreaddk的，隐约的感觉到好像中毒了，一搜发现这是一个挖矿的木马程序。</p>
<p>把进程Kill掉后，发现过一会又启动了。看来还是要深度清理了，参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/wzysz117/article/details/122662915">《挖矿木马kthreaddk清理》</a>这篇文章后，终于把这个木马清理了。主要是安装Gitlab时会创建一个git的用户，而木马程序就是这个用户下运行的，定时任务也是在这个用户下。遇到的主要问题是我不知道git用户的密码，不过这个可以用root账号来修改。</p>
<h4 id="修改Git用户密码"><a href="#修改Git用户密码" class="headerlink" title="修改Git用户密码"></a>修改Git用户密码</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd git <span class="comment"># 这个是修改用户密码，用户密码密码无法查看，即使你是管理员。</span></span><br></pre></td></tr></table></figure>

<h4 id="清理木马"><a href="#清理木马" class="headerlink" title="清理木马"></a>清理木马</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">su git <span class="comment"># 切换到git用户</span></span><br><span class="line"></span><br><span class="line">crontab -l <span class="comment"># 查看定时任务</span></span><br><span class="line"></span><br><span class="line">sudo /etc/init.d/cron stop <span class="comment"># 停掉定时程序</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">kill</span> -9 进程ID 进程ID <span class="comment"># 这个木马会有两个进程</span></span><br><span class="line"></span><br><span class="line">crontab -r <span class="comment"># 移除定时任务</span></span><br><span class="line"></span><br><span class="line">sudo /etc/init.d/cron start <span class="comment"># 重启定时任务</span></span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>整个Gillab的故障中我一直没有想到中毒的问题，而上次出现故障时，我发现Gitlab账户多了一个管理员的用户，遂即就把这个用户给禁用了，这就已经是一个预兆了。通过这次事件，也算是给上了一课，之前也有使用top这个命令，但从来没有过深入的理解。另外开源的这些软件的漏洞的问题，也是值得关注的，搞不好就有被利用的可能性。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2022/02/23/2022-02-23-spring-cloud-stream-practices/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/02/23/2022-02-23-spring-cloud-stream-practices/" class="post-title-link" itemprop="url">Spring Cloud Stream 实践</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-02-23 14:10:11 / 修改时间：15:49:11" itemprop="dateCreated datePublished" datetime="2022-02-23T14:10:11+08:00">2022-02-23</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>消息队列这个东西一直有关注，RabbitMQ相关的东西书籍也入手了，也跑过简单的例子，不过一直没有上。一开始使用的是Spring Boot集成RabbitMQ的方案，因为用的是Spring Cloud的微服务解决方案，发现Spring Cloud Stream这个东西，用这个的好处就是这是一个高层次的实现，可以支持RabbitMQ和Kafka，所以后续切换也方便。</p>
<h4 id="Source、Sink、Processor"><a href="#Source、Sink、Processor" class="headerlink" title="Source、Sink、Processor"></a>Source、Sink、Processor</h4><p>这三个是Spring Cloud Stream自带的，Source用来发送消息、Sink用来接收消息，Processor集成了二者。最初的构想是一个微服务生产消息，另一个微服务消费这些消息，我一开始用的是<code>@EnableBinding(value = &#123;Processor.class&#125;)</code>注解，这样话等于我要同时处理生产和消费的东西。如果只是实现我最初的构想的话，只需要绑定Source或者Sink其中一个就好。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>Spring Cloud Stream网上的资料并不多，一开始上手有点难。</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/fengzheng/p/11576661.html">Spring Cloud 系列之 Spring Cloud Stream </a></p>
<p><a target="_blank" rel="noopener" href="https://www.hangge.com/blog/cache/detail_2794.html">消息驱动微服务框架Spring Cloud Stream使用详解2（基本用法）</a><br>这个文章广告比较多</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/11/12/2021-11-12-remembering-a-gitlab-failure/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/12/2021-11-12-remembering-a-gitlab-failure/" class="post-title-link" itemprop="url">记Gitlab一次故障</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-12 11:52:59" itemprop="dateCreated datePublished" datetime="2021-11-12T11:52:59+08:00">2021-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-17 10:53:39" itemprop="dateModified" datetime="2022-03-17T10:53:39+08:00">2022-03-17</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Gitlab部署后一年多基本没出问题，最近一次提交突然失败，后台也登不上去了，显示502错误页面。用<code>top</code>命令确实发现CPU飙升，满负荷运行，怎么办呢？</p>
<h4 id="重启"><a href="#重启" class="headerlink" title="重启"></a>重启</h4><p>重启可能是最实用的方法吧，于是我第一步就先重启，刚一开始还能访问下，但很快就不行了，发现CUP还是很高。</p>
<h4 id="升级"><a href="#升级" class="headerlink" title="升级"></a>升级</h4><p>后来发现好像是Gitlab漏洞的问题，于是就像想着赶紧升级到最新的版本吧。一顿猛操作，就把版本升级到最新的版本了，但还是无法访问，CPU还是占用很高。</p>
<h4 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h4><p>使用<code>gitlab-ctl start</code>后并没有哪个是异常的，然后使用<code>gitlab-ctl status</code>，也是没有看出问题。最后决定查看日志吧，其实这个应该是最先想到的，可是每次都有点滞后。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/var/log/gitlab/gitlab-rails/production.log <span class="comment"># Gitlab日志目录</span></span><br><span class="line"></span><br><span class="line">gitlab-ctl <span class="built_in">tail</span> <span class="comment"># 也可以用这个查询</span></span><br></pre></td></tr></table></figure>

<p>发现是数据库连接的问题，最新版本和我原来的数据是不同的版本，无法直接升级。</p>
<h4 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h4><p>我之前安装的Gitlab是什么版本？原来也没有太注意。但这个很重要，我最后是通过备份文件的后缀知道我原来安装的版本的，我根据Postgres报错信息，定位到了原来的Postgres是11，但是发现Gitlab12和13版本，我先选择的12，是可以访问了，但是项目点进去后项目显示不存在。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /opt/gitlab/embedded/service/gitlab-rails/VERSION <span class="comment"># 比较靠谱</span></span><br><span class="line">网址/help <span class="comment"># 这个也可以查，但是网站502时不行。</span></span><br><span class="line">sudo gitlab-rake gitlab:<span class="built_in">env</span>:info <span class="comment"># 这个方法，我第一次使用的时候，因为有个报错所以也不行。</span></span><br></pre></td></tr></table></figure>

<h4 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h4><p>我已经有点想放弃了，干脆重装或者换个Gitlab类似的东西。可作为一个技术，还是决定再试下。网上说要恢复备份，好在Gitlab有一个默认备份，大概是7天备份一次，还好我最近一直没有提交过。我决定恢复备份，结果发现版本不对，备份的后缀有一个版本号，是13.0.4，而我装的是12。于是又下载重装了版本。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/opt/gitlab/backups <span class="comment"># 默认备份路径</span></span><br></pre></td></tr></table></figure>

<p>重装后实际上还不能访问，需要恢复备份。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:backup:restore BACKUP=需要恢复的版本名称 <span class="comment"># _gitlab_backup.tar 之前的所有。</span></span><br></pre></td></tr></table></figure>

<p>最后成功运行。</p>
<h4 id="问题点"><a href="#问题点" class="headerlink" title="问题点"></a>问题点</h4><p>执行<code>gitlab-ctl reconfigure</code>报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PG::ConnectionBad: could not connect to server: No such file or directory</span><br><span class="line">Is the server running locally and accepting</span><br><span class="line">connections on Unix domain socket “/var/opt/gitlab/postgresql/.s.PGSQL.5432”?</span><br></pre></td></tr></table></figure>

<p>解决方案</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo gitlab-ctl stop <span class="comment"># 停止gitlab</span></span><br><span class="line">sudo <span class="built_in">chmod</span> 755 /var/opt/gitlab/postgresql</span><br><span class="line">sudo systemctl restart gitlab-runsvdir</span><br><span class="line">sudo gitlab-ctl reconfigure</span><br><span class="line">sudo gitlab-ctl restart</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>应该解决问题，而不是轻易的重装。</p>
<ol>
<li>出现故障不要轻易的跨版本升级，比如Postgres的版本就有点频繁，而Gitlab也好像喜欢用最新的版本。</li>
<li>一定要记住当前的版本</li>
<li>备份</li>
<li>出现问题先看日志</li>
<li>机器配置，我的机子是单核4G的理论上是可以的，CPU占用率在50%上下，内存占有率也是在50%左右，实际上是可以运行的。</li>
</ol>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a target="_blank" rel="noopener" href="https://packages.gitlab.com/gitlab">Gitlab官方包中心</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jxd283465/p/11525629.html">gitlab安装、备份、恢复、升级、内存消耗问题</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/10/06/2021-10-06-tenth-anniversary-of-steve-jobs-death/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/06/2021-10-06-tenth-anniversary-of-steve-jobs-death/" class="post-title-link" itemprop="url">乔布斯去世十周年</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-06 15:12:42" itemprop="dateCreated datePublished" datetime="2021-10-06T15:12:42+08:00">2021-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-08 11:20:33" itemprop="dateModified" datetime="2021-10-08T11:20:33+08:00">2021-10-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="移动市场发展缓慢"><a href="#移动市场发展缓慢" class="headerlink" title="移动市场发展缓慢"></a>移动市场发展缓慢</h4><p>经过十年的发展，移动市场的机会似乎越来越少了。我也从iOS开发者，转做服务端开发了。iPhone是越来越贵了，我的6s已经扛过了第五个年头了。随着个人开发技能的提高，我现在反而喜欢纯粹的Linux手机。不过这类手机太少了，淘宝上购买的PinePhone自从6月中旬购买后，到现在也没有到货，只能寄希望于国庆后了。</p>
<p>移动设备的性能已经高过了需求，有些东西正在朝着另外一些方向转移，比如物联网。不过我观察了半天感觉这块市场太碎了，不好插手。</p>
<h4 id="乙川弘文"><a href="#乙川弘文" class="headerlink" title="乙川弘文"></a>乙川弘文</h4><p>十年间乔布斯相关的书籍出版不少，即使连给乔布斯做过寿司的老板也出书了，可是关于乙川弘文的书籍却没有出版，早期确实是没有的，不过后来有人根据他生前的录音整理了一本关于他的书籍《kobun-sesshin-talks》，后来16年出版后叫《Embracing Mind》。不过这么些年过去了，此书的中文版一直没有面世，我买过此书的英文版，大略的毒了一遍，觉得这事一本跟《禅者的初心》不太一样的书籍，对于打坐修行的人来说是非常有参考价值，从去年开始我就利用机器翻译加人工校对的形式在整理此书，最近终于把剩余的给全部弄完了。已经放到了GitHub上《<a target="_blank" rel="noopener" href="https://github.com/jasper2007111/kobun-sesshin-talks-zh">kobun-sesshin-talks</a>》，喜欢的可以去看看，欢迎共同完善。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/10/01/2021-10-01-cat-diary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/01/2021-10-01-cat-diary/" class="post-title-link" itemprop="url">养猫日记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-01 22:20:02" itemprop="dateCreated datePublished" datetime="2021-10-01T22:20:02+08:00">2021-10-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-02-20 16:47:14" itemprop="dateModified" datetime="2022-02-20T16:47:14+08:00">2022-02-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近养了只NY11的金渐层妹妹，大概已经半个多月了，谈谈一些感受。</p>
<h4 id="猫毛和灰尘，戴森吸尘器"><a href="#猫毛和灰尘，戴森吸尘器" class="headerlink" title="猫毛和灰尘，戴森吸尘器"></a>猫毛和灰尘，戴森吸尘器</h4><p>猫毛无处不在，关键会有一些比较小的绒毛很容易飞在空气中，搞不好就回吸进去，所以也能理解有些人猫过敏。灰尘弥漫，猫经常会发疯似得满屋子狂奔，床底平时不太打扫得到，很容易被猫带出来，养猫后灰尘感觉弥漫在空气一样。面对这两个问题，我狠心买了个戴森吸尘器V10，首先这个确实可以把地板上散落的猫毛和灰尘以及一些杂质给收集起来，另外对于椅子上的猫毛也能清理，但还是有照顾不到的地方，总的来说解决一些问题。</p>
<h4 id="危险"><a href="#危险" class="headerlink" title="危险"></a>危险</h4><p>防止猫触发水龙头，一般的水龙不太会有问题，不过类似面盆之类的水龙头只需要简单的抬起和按下，这类水龙头会有隐患。</p>
<p>对于猫咪感兴趣但有危险的行为，一定要在发现的第一时间采取行动，猫是属于好奇心很重的那种。</p>
<h4 id="寄养"><a href="#寄养" class="headerlink" title="寄养"></a>寄养</h4><p>短暂的几天其实倒还好，但是如果出差之类的，在这个疫情大背景下，确实有万一被隔离的潜在风险，所以作为单身人士而言最好把猫寄养了。寄养确实也贵，有些是全包，有些要求自带猫粮或者猫粮和猫砂都需要带，另外有些会要求必须是打了疫苗的、绝育的等。所以找一家合适的家养猫的确实也不容易。</p>
<h4 id="公猫还是母猫？"><a href="#公猫还是母猫？" class="headerlink" title="公猫还是母猫？"></a>公猫还是母猫？</h4><p>我一开始以为公猫发情后会乱尿，所以选择了母猫。但实际上母猫也会乱尿，这是一位养母猫的朋友亲身经历。公猫会发腮，这会给颜值加分，如果比较看重颜值的话，还是要先考虑公猫。有人说母猫可以繁殖，所以价格会更贵一点，我没有发现，更多的是看颜值了。如果真的要繁育猫，首先也得找好的种公也是要花钱的，另外生下来能不能卖出去并卖上一个价也是一个问题，母猫绝育也比较麻烦，更有风险。</p>
<h4 id="病"><a href="#病" class="headerlink" title="病"></a>病</h4><p>猫不在多，而在于健康。最近发现猫开始呕吐，那天还蛮严重的，因为一直喂罐头的缘故，可能加了诱食剂，后来自己好了。</p>
<p>过年的时候，送去寄养结果就又呕吐了，最后专门到医院打针，后来想想环境的变动也会猫有一定的影响。</p>
<h4 id="疫苗"><a href="#疫苗" class="headerlink" title="疫苗"></a>疫苗</h4><p>关于疫苗，买猫的时候，老板说打了一针的疫苗，但也没有疫苗本，所以又重新从第一针开打。就像现在每天要扫码一样，疫苗也是你的猫咪在社会上流通的通行证，寄养也好、做绝育都需要有疫苗本。</p>
<p>目前我的猫已经打了三针了，最后还有一个狂犬疫苗。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/09/26/2021-09-26-virtualbox-centos-8-expansio/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/26/2021-09-26-virtualbox-centos-8-expansio/" class="post-title-link" itemprop="url">Virtualbox CentOS 8扩容</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-26 15:28:43" itemprop="dateCreated datePublished" datetime="2021-09-26T15:28:43+08:00">2021-09-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-09 11:08:09" itemprop="dateModified" datetime="2021-10-09T11:08:09+08:00">2021-10-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本来想在虚拟机上安装TDengine试试，经过一番折腾后发现磁盘容量不足，当时创建虚拟机时选择的是8G，这就尴尬了，最后还是一番折腾后终于扩容成功。</p>
<h3 id="VirtualBox"><a href="#VirtualBox" class="headerlink" title="VirtualBox"></a>VirtualBox</h3><p>先关闭虚拟机，在虚拟机运行目录下执行。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VBoxManage modifyhd /Users/jasperji/VirtualBox\ VMs/centos8/centos8.vdi --resize 15360 </span><br></pre></td></tr></table></figure>

<p>这里我把容量扩展为15G，记住路径中空格的问题。</p>
<h3 id="CentOS"><a href="#CentOS" class="headerlink" title="CentOS"></a>CentOS</h3><p>查看磁盘容量情况</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h</span><br></pre></td></tr></table></figure>

<p>操作分区，选项n，创建新分区。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk /dev/sda</span><br></pre></td></tr></table></figure>

<p>创建PV（物理卷）</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pvcreate /dev/sda3</span><br></pre></td></tr></table></figure>

<p>扩展到卷组，我们vgdisplay命令查看一下自己所在的卷组：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pvdisplay</span><br></pre></td></tr></table></figure>

<p>看到VG Name是cl，所以进一步扩展到卷组：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vgextend cl /dev/sda3</span><br></pre></td></tr></table></figure>

<p>扩展到逻辑分区，使用lvextend（logical volume extend逻辑卷扩展）</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lvextend /dev/cl/root /dev/sda3</span><br></pre></td></tr></table></figure>

<p>我们df -h查看一下文件系统的磁盘空间占用情况：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h</span><br></pre></td></tr></table></figure>

<p><em>这里我们发现磁盘没有按照预期的扩容，因为我们没有刷新逻辑分区的容量。</em></p>
<p>于是，刷新逻辑分区的容量，使用xfs_growfs（同步文件系统）命令，注意上面的Mounted on是挂载点，这里我们的挂载点就是根目录：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_growfs /</span><br></pre></td></tr></table></figure>

<p>最后就扩容成功了。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>其实之前阿里云正式服务器的时候，也记得有挂载过当时购买的云硬盘。不过时间久了，当时也没有记录一些东西，也就忘了。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Luylic/article/details/107366701">CentOS8扩容</a><br><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904003067707399">VirtualBox虚拟机硬盘扩容及LVM命令介绍</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cthon/p/9334828.html">VirtualBox文件系统已满–磁盘扩容</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://c2lang.com/2021/09/08/2021-09-08-learning-java-bytecode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jasper Ji">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jasper Ji">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/08/2021-09-08-learning-java-bytecode/" class="post-title-link" itemprop="url">学习Java字节码</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-09-08 09:21:48 / 修改时间：14:31:51" itemprop="dateCreated datePublished" datetime="2021-09-08T09:21:48+08:00">2021-09-08</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Java字节码只是简单的了解，感觉缺乏深入的了解，特写此篇记录下。</p>
<p>准备一个HelloWorld的测试类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译生成HelloWorld.class文件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac HelloWorld.java</span><br></pre></td></tr></table></figure>

<p>我们使用javap命令来查看class文件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javap -v HelloWorld.class</span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">Classfile /Users/jasperji/eclipse-workspace/maventest/src/main/java/com/jasper/ji/maven/test/HelloWorld.class</span><br><span class="line">  Last modified 2021-9-8; size 452 bytes</span><br><span class="line">  MD5 checksum 1f346aeb85559b06180507b8838406dd</span><br><span class="line">  Compiled from <span class="string">&quot;HelloWorld.java&quot;</span></span><br><span class="line">public class com.jasper.ji.maven.test.HelloWorld</span><br><span class="line">  minor version: 0</span><br><span class="line">  major version: 52</span><br><span class="line">  flags: ACC_PUBLIC, ACC_SUPER</span><br><span class="line">Constant pool:</span><br><span class="line">   <span class="comment">#1 = Methodref          #6.#15         // java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   <span class="comment">#2 = Fieldref           #16.#17        // java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">   <span class="comment">#3 = String             #18            // Hello, World!</span></span><br><span class="line">   <span class="comment">#4 = Methodref          #19.#20        // java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">   <span class="comment">#5 = Class              #21            // com/jasper/ji/maven/test/HelloWorld</span></span><br><span class="line">   <span class="comment">#6 = Class              #22            // java/lang/Object</span></span><br><span class="line">   <span class="comment">#7 = Utf8               &lt;init&gt;</span></span><br><span class="line">   <span class="comment">#8 = Utf8               ()V</span></span><br><span class="line">   <span class="comment">#9 = Utf8               Code</span></span><br><span class="line">  <span class="comment">#10 = Utf8               LineNumberTable</span></span><br><span class="line">  <span class="comment">#11 = Utf8               main</span></span><br><span class="line">  <span class="comment">#12 = Utf8               ([Ljava/lang/String;)V</span></span><br><span class="line">  <span class="comment">#13 = Utf8               SourceFile</span></span><br><span class="line">  <span class="comment">#14 = Utf8               HelloWorld.java</span></span><br><span class="line">  <span class="comment">#15 = NameAndType        #7:#8          // &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">  <span class="comment">#16 = Class              #23            // java/lang/System</span></span><br><span class="line">  <span class="comment">#17 = NameAndType        #24:#25        // out:Ljava/io/PrintStream;</span></span><br><span class="line">  <span class="comment">#18 = Utf8               Hello, World!</span></span><br><span class="line">  <span class="comment">#19 = Class              #26            // java/io/PrintStream</span></span><br><span class="line">  <span class="comment">#20 = NameAndType        #27:#28        // println:(Ljava/lang/String;)V</span></span><br><span class="line">  <span class="comment">#21 = Utf8               com/jasper/ji/maven/test/HelloWorld</span></span><br><span class="line">  <span class="comment">#22 = Utf8               java/lang/Object</span></span><br><span class="line">  <span class="comment">#23 = Utf8               java/lang/System</span></span><br><span class="line">  <span class="comment">#24 = Utf8               out</span></span><br><span class="line">  <span class="comment">#25 = Utf8               Ljava/io/PrintStream;</span></span><br><span class="line">  <span class="comment">#26 = Utf8               java/io/PrintStream</span></span><br><span class="line">  <span class="comment">#27 = Utf8               println</span></span><br><span class="line">  <span class="comment">#28 = Utf8               (Ljava/lang/String;)V</span></span><br><span class="line">&#123;</span><br><span class="line">  public com.jasper.ji.maven.test.HelloWorld();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=1, locals=1, args_size=1</span><br><span class="line">         0: aload_0</span><br><span class="line">         1: invokespecial <span class="comment">#1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         4: <span class="built_in">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 3: 0</span><br><span class="line"></span><br><span class="line">  public static void main(java.lang.String[]);</span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=2, locals=1, args_size=1</span><br><span class="line">         0: getstatic     <span class="comment">#2                  // Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">         3: ldc           <span class="comment">#3                  // String Hello, World!</span></span><br><span class="line">         5: invokevirtual <span class="comment">#4                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">         8: <span class="built_in">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 5: 0</span><br><span class="line">        line 6: 8</span><br><span class="line">&#125;</span><br><span class="line">SourceFile: <span class="string">&quot;HelloWorld.java&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>另外也可以直接查看二进制，这里使用hexdump。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexdump HelloWorld.class</span><br></pre></td></tr></table></figure>

<p>不过感觉还是javap提供的这个比较人性化，更好的阅读。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>字节码作为一种中间形式，Java可以编译成字节码，Scala也可以编译成字节码，但是从语言层面他们又是不一样的。这个也让我重新再读了下《Java程序员修炼之道》这本书，原来对于书中第三部分JVM上的多语言编程，不是很感冒。但字节码并不是机器码，所以在理解某些问题时最终还是要落到汇编语言级别的。</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a target="_blank" rel="noopener" href="https://tech.meituan.com/2019/09/05/java-bytecode-enhancement.html">字节码增强技术探索</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jasper Ji</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">50</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jasper Ji</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
